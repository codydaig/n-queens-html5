<!DOCTYPE html>
<html>
  <head>
    <title>n-rooks solver</title>
    <link rel="stylesheet" href="main.css"/>
  </head>
  <body>

    <div id="status">
      Calculating...
    </div>
    <div id="found">
    0
    </div>
    <div id="results">
    </div>

    <div id="board-container">
    </div>

    <script>
      
      var n = 5;
      var container = document.getElementById('board-container');
      var counter = document.getElementById('found');
      var count = 0;
      for(var x = 0; x < n; x++) {
        var row = document.createElement('DIV');
        row.className = 'row';

        for(var y = 0; y < n; y++) {
          var node = document.createElement('DIV');
          node.textContent = "";
          if((x+y) % 2 === 0){
            node.className = 'cell even';
          } else {
            node.className = 'cell odd';
          }
          
          node.id = x + '_' + y;
          // ToDo: We can alternate and create "odd" rows for the pattern

          row.appendChild(node);
          //c.textContent += 'TEST';
        }
        container.appendChild(row);
      }
    </script>

    <script>
      // This function uses a board visualizer lets you view an interactive version of any piece matrix.

      var worker = new Worker('worker.js');
      worker.postMessage(n);

      worker.addEventListener('message', function(e){
        var data = e.data;
        if(data['msg'] === 'done'){
          document.getElementById('status').textContent = 'All finished!';
        }
        if(data['msg'] === 'found'){
          var rowData = data['payload'];
          //console.log(rowData);
          //debugger;
          count++;
          counter.textContent = count;
          for(var x = 0; x < rowData.length; x++) {
            for (var y = 0; y < rowData[x].length; y++) {
              //console.log(x+'_'+y);
              var element = document.getElementById(x+'_'+y);
              element.textContent = data['payload'][x][y] === 1 ? ':)' : '';
              
              if(data['payload'][x][y] === 1) {
                element.className = 'cell pos';
              } else {
                element.className = 'cell neg';
              }
              if((x+y) % 2 === 0){
                element.className += ' even';
              } else {
                element.className += ' odd';
              }
            }
          }
          //document.getElementById('results').textContent += data['payload'];
        }
      });
      /*
      window.displayBoard = function(matrix){
        $('body').html(
          new BoardView({
            model: new Board(matrix)
          }).render()
        );
      };
      $(function(){
        // this is a pre-baked solution for n-queens in the n = 4 case, rendered to the screen using our handy visualizer.
        displayBoard([
          [0, 1, 0, 0],
          [0, 0, 0, 1],
          [1, 0, 0, 0],
          [0, 0, 1, 0]
        ]);

        var n = 4;
        findNRooksSolution(n);
        countNRooksSolutions(n);
        findNQueensSolution(n);
        countNQueensSolutions(n);
      });*/
    </script>
  </body>
</html>
